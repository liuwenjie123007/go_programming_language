=== RUN   TestConcurrent
objc[26439]: Attempt to use unknown class 0x7ff85d8d9360.
SIGABRT: abort
PC=0x7ff81c0a5dfe m=5 sigcode=0

goroutine 0 [idle]:
runtime: unknown pc 0x7ff81c0a5dfe
stack: frame={sp:0x70000d7a8e58, fp:0x0} stack=[0x70000d72a338,0x70000d7a9f38)
0x000070000d7a8d58:  0x0000000000000002  0x0000000000000002 
0x000070000d7a8d68:  0x000000000215d000  0x000000000215d400 
0x000070000d7a8d78:  0x0000000000000006  0x000070000d7a8de0 
0x000070000d7a8d88:  0x00007ff81bedb639  0x0000000000000000 
0x000070000d7a8d98:  0xf6b84000c0001006  0x000000000000ffff 
0x000070000d7a8da8:  0x0000000000000030  0x0000000000000000 
0x000070000d7a8db8:  0x000000000000002d  0x000000000000002d 
0x000070000d7a8dc8:  0x0000000000000000  0x000000000215d000 
0x000070000d7a8dd8:  0x00007ff85d8ed000  0x000070000d7a8e10 
0x000070000d7a8de8:  0x00007ff81bedb566  0x00007ff81bedb52e 
0x000070000d7a8df8:  0x000000000000002d  0x0000000000000001 
0x000070000d7a8e08:  0x00007ff85d8ed000  0x000070000d7a8e50 
0x000070000d7a8e18:  0x00007ff81bef7ad6  0x000000000000002c 
0x000070000d7a8e28:  0x000000000000002d  0x0000600003300000 
0x000070000d7a8e38:  0x0000000000000003  0x0000600002c00000 
0x000070000d7a8e48:  0x0000000000000000  0x000070000d7a8e80 
0x000070000d7a8e58: <0x00007ff81c0a7893  0x0000000000000000 
0x000070000d7a8e68:  0x000000200d7a8ec0  0x0000600002c00000 
0x000070000d7a8e78:  0x000070000d7a8ec0  0x0000600003300000 
0x000070000d7a8e88:  0x0000000000000003  0x0000000000000080 
0x000070000d7a8e98:  0x0000000000000001  0x000070000d7a8eb0 
0x000070000d7a8ea8:  0x00007ff81c0a7843  0x000070000d7a8ef0 
0x000070000d7a8eb8:  0x00007ff81bf73bce  0x0000600002c00080 
0x000070000d7a8ec8:  0x0000000000000000  0x0000600002c00000 
0x000070000d7a8ed8:  0x00007ffffffffff8  0x00007ff85d8d9360 
0x000070000d7a8ee8:  0x0000000080080001  0x000070000d7a8fd0 
0x000070000d7a8ef8:  0x00007ff81bf73b5c  0x0000003000000010 
0x000070000d7a8f08:  0x000070000d7a8fe0  0x000070000d7a8f20 
0x000070000d7a8f18:  0x0000000000000000  0x0000000000000000 
0x000070000d7a8f28:  0x00007ff85d8d9360  0x00007ff85d8d9360 
0x000070000d7a8f38:  0x0000000000000001  0x00000000ffffffff 
0x000070000d7a8f48:  0x0000000000000000  0x0000000000000000 
runtime: unknown pc 0x7ff81c0a5dfe
stack: frame={sp:0x70000d7a8e58, fp:0x0} stack=[0x70000d72a338,0x70000d7a9f38)
0x000070000d7a8d58:  0x0000000000000002  0x0000000000000002 
0x000070000d7a8d68:  0x000000000215d000  0x000000000215d400 
0x000070000d7a8d78:  0x0000000000000006  0x000070000d7a8de0 
0x000070000d7a8d88:  0x00007ff81bedb639  0x0000000000000000 
0x000070000d7a8d98:  0xf6b84000c0001006  0x000000000000ffff 
0x000070000d7a8da8:  0x0000000000000030  0x0000000000000000 
0x000070000d7a8db8:  0x000000000000002d  0x000000000000002d 
0x000070000d7a8dc8:  0x0000000000000000  0x000000000215d000 
0x000070000d7a8dd8:  0x00007ff85d8ed000  0x000070000d7a8e10 
0x000070000d7a8de8:  0x00007ff81bedb566  0x00007ff81bedb52e 
0x000070000d7a8df8:  0x000000000000002d  0x0000000000000001 
0x000070000d7a8e08:  0x00007ff85d8ed000  0x000070000d7a8e50 
0x000070000d7a8e18:  0x00007ff81bef7ad6  0x000000000000002c 
0x000070000d7a8e28:  0x000000000000002d  0x0000600003300000 
0x000070000d7a8e38:  0x0000000000000003  0x0000600002c00000 
0x000070000d7a8e48:  0x0000000000000000  0x000070000d7a8e80 
0x000070000d7a8e58: <0x00007ff81c0a7893  0x0000000000000000 
0x000070000d7a8e68:  0x000000200d7a8ec0  0x0000600002c00000 
0x000070000d7a8e78:  0x000070000d7a8ec0  0x0000600003300000 
0x000070000d7a8e88:  0x0000000000000003  0x0000000000000080 
0x000070000d7a8e98:  0x0000000000000001  0x000070000d7a8eb0 
0x000070000d7a8ea8:  0x00007ff81c0a7843  0x000070000d7a8ef0 
0x000070000d7a8eb8:  0x00007ff81bf73bce  0x0000600002c00080 
0x000070000d7a8ec8:  0x0000000000000000  0x0000600002c00000 
0x000070000d7a8ed8:  0x00007ffffffffff8  0x00007ff85d8d9360 
0x000070000d7a8ee8:  0x0000000080080001  0x000070000d7a8fd0 
0x000070000d7a8ef8:  0x00007ff81bf73b5c  0x0000003000000010 
0x000070000d7a8f08:  0x000070000d7a8fe0  0x000070000d7a8f20 
0x000070000d7a8f18:  0x0000000000000000  0x0000000000000000 
0x000070000d7a8f28:  0x00007ff85d8d9360  0x00007ff85d8d9360 
0x000070000d7a8f38:  0x0000000000000001  0x00000000ffffffff 
0x000070000d7a8f48:  0x0000000000000000  0x0000000000000000 

goroutine 52 [syscall]:
runtime.cgocall(0x1001080, 0xc000093ca0)
	/usr/local/opt/go/libexec/src/runtime/cgocall.go:156 +0x6e fp=0xc000093c78 sp=0xc000093c40 pc=0x104452e
net._C2func_getaddrinfo(0xc0000b2035, 0x0, 0xc0000982a0, 0xc00009c028)
	_cgo_gotypes.go:97 +0x8b fp=0xc000093ca0 sp=0xc000093c78 pc=0x128550b
net.cgoLookupIPCNAME.func1({0xc0000b2035, 0xb, 0xc0000b2012}, 0x0, 0x1671100)
	/usr/local/opt/go/libexec/src/net/cgo_unix.go:163 +0xb2 fp=0xc000093d10 sp=0xc000093ca0 pc=0x1287bd2
net.cgoLookupIPCNAME({0x140d924, 0x3}, {0xc0000b2012, 0xc000128018})
	/usr/local/opt/go/libexec/src/net/cgo_unix.go:163 +0x26e fp=0xc000093f10 sp=0xc000093d10 pc=0x12870ce
net.cgoIPLookup(0x1671110, {0x140d924, 0x3}, {0xc0000b2012, 0xa})
	/usr/local/opt/go/libexec/src/net/cgo_unix.go:220 +0x67 fp=0xc000093f80 sp=0xc000093f10 pc=0x1287ce7
net.cgoLookupIP·dwrap·22()
	/usr/local/opt/go/libexec/src/net/cgo_unix.go:230 +0x72 fp=0xc000093fe0 sp=0xc000093f80 pc=0x1288392
runtime.goexit()
	/usr/local/opt/go/libexec/src/runtime/asm_amd64.s:1581 +0x1 fp=0xc000093fe8 sp=0xc000093fe0 pc=0x10ab5e1
created by net.cgoLookupIP
	/usr/local/opt/go/libexec/src/net/cgo_unix.go:230 +0x1ba

goroutine 1 [chan receive]:
testing.(*T).Run(0xc000103860, {0x141054e, 0xe}, 0x14263f8)
	/usr/local/opt/go/libexec/src/testing/testing.go:1307 +0x752
testing.runTests.func1(0x0)
	/usr/local/opt/go/libexec/src/testing/testing.go:1598 +0x9a
testing.tRunner(0xc000103860, 0xc000137bf8)
	/usr/local/opt/go/libexec/src/testing/testing.go:1259 +0x230
testing.runTests(0xc000180000, {0x1666f60, 0x2, 0x2}, {0x0, 0x9afffff, 0x16717a0})
	/usr/local/opt/go/libexec/src/testing/testing.go:1596 +0x7cb
testing.(*M).Run(0xc000180000)
	/usr/local/opt/go/libexec/src/testing/testing.go:1504 +0x9d2
main.main()
	_testmain.go:47 +0x22c

goroutine 19 [semacquire]:
sync.runtime_Semacquire(0xc000128474)
	/usr/local/opt/go/libexec/src/runtime/sema.go:56 +0x25
sync.(*WaitGroup).Wait(0xc000128474)
	/usr/local/opt/go/libexec/src/sync/waitgroup.go:130 +0xea
gopl.io/ch9/memotest.Concurrent(0x1087feb, {0x147fa20, 0xc00013c168})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:78 +0x21a
gopl.io/ch9/memo2_test.TestConcurrent(0x0)
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2_test.go:16 +0x11d
testing.tRunner(0xc000103a00, 0x14263f8)
	/usr/local/opt/go/libexec/src/testing/testing.go:1259 +0x230
created by testing.(*T).Run
	/usr/local/opt/go/libexec/src/testing/testing.go:1306 +0x727

goroutine 21 [select]:
net/http.(*Transport).getConn(0x166bdc0, 0xc0000b4000, {{}, 0x0, {0x1411bbe, 0x5}, {0xc0000b2012, 0xe}, 0x0})
	/usr/local/opt/go/libexec/src/net/http/transport.go:1372 +0xa45
net/http.(*Transport).roundTrip(0x166bdc0, 0xc00009a000)
	/usr/local/opt/go/libexec/src/net/http/transport.go:581 +0xcdf
net/http.(*Transport).RoundTrip(0xc00009a000, 0x147fb80)
	/usr/local/opt/go/libexec/src/net/http/roundtrip.go:18 +0x37
net/http.send(0xc00009a000, {0x147fb80, 0x166bdc0}, {0x0, 0x108fca0, 0x0})
	/usr/local/opt/go/libexec/src/net/http/client.go:252 +0x93f
net/http.(*Client).send(0x1671440, 0xc00009a000, {0x105854f, 0x14, 0x0})
	/usr/local/opt/go/libexec/src/net/http/client.go:176 +0x158
net/http.(*Client).do(0x1671440, 0xc00009a000)
	/usr/local/opt/go/libexec/src/net/http/client.go:725 +0x1087
net/http.(*Client).Do(...)
	/usr/local/opt/go/libexec/src/net/http/client.go:593
net/http.(*Client).Get(0x0, {0x1411bbe, 0x12})
	/usr/local/opt/go/libexec/src/net/http/client.go:480 +0xb1
net/http.Get(...)
	/usr/local/opt/go/libexec/src/net/http/client.go:449
gopl.io/ch9/memotest.httpGetBody({0x1411bbe, 0x12})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:14 +0x85
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1411bbe, 0x12})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:29 +0xf9
gopl.io/ch9/memotest.Concurrent.func1({0x1411bbe, 0x12})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 22 [semacquire]:
sync.runtime_SemacquireMutex(0x0, 0x0, 0x0)
	/usr/local/opt/go/libexec/src/runtime/sema.go:71 +0x25
sync.(*Mutex).lockSlow(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:138 +0x21d
sync.(*Mutex).Lock(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:81 +0x65
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1411578, 0x11})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:26 +0x55
gopl.io/ch9/memotest.Concurrent.func1({0x1411578, 0x11})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 23 [semacquire]:
sync.runtime_SemacquireMutex(0x0, 0x0, 0x0)
	/usr/local/opt/go/libexec/src/runtime/sema.go:71 +0x25
sync.(*Mutex).lockSlow(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:138 +0x21d
sync.(*Mutex).Lock(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:81 +0x65
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1413a54, 0x17})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:26 +0x55
gopl.io/ch9/memotest.Concurrent.func1({0x1413a54, 0x17})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 24 [semacquire]:
sync.runtime_SemacquireMutex(0x0, 0x0, 0x0)
	/usr/local/opt/go/libexec/src/runtime/sema.go:71 +0x25
sync.(*Mutex).lockSlow(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:138 +0x21d
sync.(*Mutex).Lock(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:81 +0x65
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1410604, 0xe})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:26 +0x55
gopl.io/ch9/memotest.Concurrent.func1({0x1410604, 0xe})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 34 [semacquire]:
sync.runtime_SemacquireMutex(0x0, 0x0, 0x0)
	/usr/local/opt/go/libexec/src/runtime/sema.go:71 +0x25
sync.(*Mutex).lockSlow(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:138 +0x21d
sync.(*Mutex).Lock(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:81 +0x65
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1411bbe, 0x12})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:26 +0x55
gopl.io/ch9/memotest.Concurrent.func1({0x1411bbe, 0x12})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 35 [semacquire]:
sync.runtime_SemacquireMutex(0x0, 0x0, 0x0)
	/usr/local/opt/go/libexec/src/runtime/sema.go:71 +0x25
sync.(*Mutex).lockSlow(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:138 +0x21d
sync.(*Mutex).Lock(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:81 +0x65
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1411578, 0x11})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:26 +0x55
gopl.io/ch9/memotest.Concurrent.func1({0x1411578, 0x11})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 36 [semacquire]:
sync.runtime_SemacquireMutex(0x0, 0x0, 0x0)
	/usr/local/opt/go/libexec/src/runtime/sema.go:71 +0x25
sync.(*Mutex).lockSlow(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:138 +0x21d
sync.(*Mutex).Lock(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:81 +0x65
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1413a54, 0x17})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:26 +0x55
gopl.io/ch9/memotest.Concurrent.func1({0x1413a54, 0x17})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 50 [select]:
net.(*Resolver).lookupIPAddr(0x1671100, {0x1486328, 0xc0000be240}, {0x140d924, 0xc000100000}, {0xc0000b2012, 0xa})
	/usr/local/opt/go/libexec/src/net/lookup.go:302 +0x81c
net.(*Resolver).internetAddrList(0x1486328, {0x1486328, 0xc0000be240}, {0x140d924, 0x3}, {0xc0000b2012, 0xe})
	/usr/local/opt/go/libexec/src/net/ipsock.go:288 +0x7c6
net.(*Resolver).resolveAddrList(0x16a1820, {0x1486328, 0xc0000be240}, {0x140daaa, 0x4}, {0x140d924, 0x3}, {0xc0000b2012, 0xe}, {0x0, ...})
	/usr/local/opt/go/libexec/src/net/dial.go:221 +0x556
net.(*Dialer).DialContext(0xc0001262a0, {0x14862f0, 0xc000128018}, {0x140d924, 0x3}, {0xc0000b2012, 0xe})
	/usr/local/opt/go/libexec/src/net/dial.go:406 +0x6e5
net/http.(*Transport).dial(0x166bdc0, {0x14862f0, 0xc000128018}, {0x140d924, 0x3}, {0xc0000b2012, 0xe})
	/usr/local/opt/go/libexec/src/net/http/transport.go:1166 +0x26a
net/http.(*Transport).dialConn(0x166bdc0, {0x14862f0, 0xc000128018}, {{}, 0x0, {0x1411bbe, 0x5}, {0xc0000b2012, 0xe}, 0x0})
	/usr/local/opt/go/libexec/src/net/http/transport.go:1604 +0xd58
net/http.(*Transport).dialConnFor(0x12, 0xc0000ba000)
	/usr/local/opt/go/libexec/src/net/http/transport.go:1446 +0x13b
created by net/http.(*Transport).queueForDial
	/usr/local/opt/go/libexec/src/net/http/transport.go:1415 +0x175

goroutine 37 [semacquire]:
sync.runtime_SemacquireMutex(0x0, 0x0, 0x0)
	/usr/local/opt/go/libexec/src/runtime/sema.go:71 +0x25
sync.(*Mutex).lockSlow(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:138 +0x21d
sync.(*Mutex).Lock(0xc00013c170)
	/usr/local/opt/go/libexec/src/sync/mutex.go:81 +0x65
gopl.io/ch9/memo2.(*Memo).Get(0xc00013c168, {0x1410604, 0xe})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memo2/memo2.go:26 +0x55
gopl.io/ch9/memotest.Concurrent.func1({0x1410604, 0xe})
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:68 +0xf3
created by gopl.io/ch9/memotest.Concurrent
	/Users/liuwenjie/git/go_programming_language/gopl.io/ch9/memotest/memotest.go:65 +0x85

goroutine 51 [select]:
net.cgoLookupIP({0x14862b8, 0xc0000b4080}, {0x140d924, 0xa}, {0xc0000b2012, 0x0})
	/usr/local/opt/go/libexec/src/net/cgo_unix.go:231 +0x289
net.(*Resolver).lookupIP(0x1671100, {0x14862b8, 0xc0000b4080}, {0x140d924, 0x3}, {0xc0000b2012, 0xa})
	/usr/local/opt/go/libexec/src/net/lookup_unix.go:97 +0x113
net.glob..func1({0x14862b8, 0xc0000b4080}, 0xc0000a4090, {0x140d924, 0x3}, {0xc0000b2012, 0xa})
	/usr/local/opt/go/libexec/src/net/hook.go:23 +0x89
net.(*Resolver).lookupIPAddr.func1()
	/usr/local/opt/go/libexec/src/net/lookup.go:296 +0x133
internal/singleflight.(*Group).doCall(0x1671110, 0xc0000c0050, {0xc0000b2022, 0xe}, 0xc0000b40c0)
	/usr/local/opt/go/libexec/src/internal/singleflight/singleflight.go:95 +0x68
created by internal/singleflight.(*Group).DoChan
	/usr/local/opt/go/libexec/src/internal/singleflight/singleflight.go:88 +0x59b

rax    0x2000209
rbx    0x80
rcx    0x70000d7a8e58
rdx    0x0
rdi    0x8
rsi    0x1
rbp    0x70000d7a8ea0
rsp    0x70000d7a8e58
r8     0x600002c00000
r9     0x80
r10    0x0
r11    0x246
r12    0x0
r13    0x0
r14    0x1
r15    0x8
rip    0x7ff81c0a5dfe
rflags 0x246
cs     0x7
fs     0x0
gs     0x0
FAIL	gopl.io/ch9/memo2	0.260s
FAIL
